!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","jquery","angular","angular-material","stratus.services.registry","stratus.services.collection","stratus.services.model","stratus.services.details","stratus.components.pagination","stratus.directives.src","stratus.services.utility","stratus.services.visualSelector"],factory):factory(root.Stratus,root._,root.jQuery,root.angular)}(this,function(Stratus,_,jQuery,angular){Stratus.Components.ThemeSelector={bindings:{elementId:"@",ngModel:"=",property:"@",type:"@",limit:"@",details:"<",isNewTheme:"@"},controller:function($scope,$mdPanel,$attrs,Registry,details,Model,$sce,Collection,$window,utility,visualSelector,$filter){utility.componentInitializer(this,$scope,$attrs,"theme_selector",!0);var $ctrl=this;function themeRawDesc(plainText){return $sce.trustAsHtml(plainText)}function zoomView(themeDetail){visualSelector.zoomviewDialog($scope,themeDetail.data,"themeDetail")}function showCategory(index){console.log("Not implement yet")}function toggleGallery(){$ctrl.showGallery=!$ctrl.showGallery}function setFavorite(id){console.log("Not implement yet")}function chooseTheme(themeData){$ctrl.selectedTheme=themeData,$scope.model.data.version.templateId=themeData.id,$scope.model.data.version.template=themeData}function finishChoosingTheme(themeData){var data={templateId:themeData.id};visualSelector.selectTheme(data).then(function(res){utility.getStatus(res).code===utility.RESPONSE_CODE.success?$window.location.href="/Site/Edit/Success":$ctrl.errorMsg=utility.getStatus(res).message})}function sortBy(type){console.log("Not implement yet")}$ctrl.$onInit=function(){$scope.api=!!_.isJSON($attrs.api)&&JSON.parse($attrs.api),$ctrl.errorMsg=null,$ctrl.heartCollor=[],$ctrl.zoomView=zoomView,$ctrl.selectedTheme=null,$ctrl.showGallery=$ctrl.isNewTheme,$ctrl.currentThemes=[],$ctrl.categories=["Lorem ipsum","Lorem ipsum","Lorem ipsum","Lorem ipsum","Lorem ipsum","Lorem ipsum"],$ctrl.sortBy=sortBy,$ctrl.setFavorite=setFavorite,$ctrl.showCategory=showCategory,$ctrl.chooseTheme=chooseTheme,$ctrl.themeRawDesc=themeRawDesc,$ctrl.toggleGallery=toggleGallery,$ctrl.finishChoosingTheme=finishChoosingTheme,$attrs.type&&($scope=visualSelector.fetchCollection($scope,$attrs,3,"Template"))},$scope.property=$attrs.property||null,$scope.toggleOptions={multiple:!!_.isJSON($attrs.multiple)&&JSON.parse($attrs.multiple)},$scope.$watch("[model.data.version.template, collection.models]",function(theme){if(theme[0]&&theme[1]&&theme[1].length>0&&($ctrl.currentThemes=theme[1],!$ctrl.selectedTheme)){var themeData=$ctrl.currentThemes.map(function(obj){return obj.data});$ctrl.selectedTheme=theme[0],$ctrl.selectedTheme=themeData.filter(function(themeItem){return themeItem.id===theme[0].id})[0]}}),$scope.model=null,$scope.$watch("$ctrl.ngModel",function(data){data instanceof Model&&data!==$scope.model&&($scope.model=data)})},templateUrl:Stratus.BaseUrl+Stratus.BundlePath+"components/themeSelector"+(Stratus.Environment.get("production")?".min":"")+".html"}});