!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","jquery","angular","angular-material","stratus.services.utility","stratus.services.media"],factory):factory(root.Stratus,root._,root.jQuery,root.angular)}(this,function(Stratus,_,jQuery,angular){Stratus.Components.MediaDragDrop={controller:function($scope,$mdDialog,$attrs,utility,media){function DialogController($scope,files){$scope.files=files,$scope.done=function(){$mdDialog.hide(),media.dragleave()},$scope.cancel=function(){$mdDialog.cancel(),media.dragleave()},$scope.addFiles=function(newFiles){newFiles.length>0&&($scope.files=Array.from($scope.files).concat(newFiles))},$scope.removeFiles=function(file){$scope.files=_.without($scope.files,file)},$scope.$watch("files",function(oldFiles,newFiles){console.log(oldFiles),console.log(newFiles)})}utility.componentInitializer(this,$scope,$attrs,"media_drag_drop",!0),$scope.isShowDialog=angular.element(document.body).hasClass("md-dialog-is-showing"),$scope.files=[],jQuery(window).focus(function(){jQuery(".drag-drop").removeClass("show-overlay")}).blur(function(){jQuery(".drag-drop").addClass("show-overlay")}),$scope.drop=function(event){angular.element(document.body).hasClass("md-dialog-is-showing")||($scope.files=$scope.files.concat(Array.from(event.dataTransfer.files)),$mdDialog.show({controller:DialogController,locals:{files:event.dataTransfer.files},templateUrl:Stratus.BaseUrl+Stratus.BundlePath+"components/mediaDragDropDialog"+(Stratus.Environment.get("production")?".min":"")+".html",parent:angular.element(document.body),clickOutsideToClose:!1}))},$scope.saveMedia=function(file){return Stratus.Environment.get("production")||console.log(["savemedia"],file),file.errorMsg=null,file.uploadStatus=!1,file.errorUpload=!1,file.upload=media.uploadToS3(file),file.upload.then(function(response){file.result=response.data,file.uploadStatus=!0,file.errorUpload=!1,$scope.infoId=null,$scope.imageSrc=file.result.url},function(rejection){!0===rejection.config.data.file.upload.aborted?(file.uploadStatus=!1,file.errorUpload=!0,file.errorMsg="Aborted"):(file.uploadStatus=!1,file.errorUpload=!0,file.errorMsg="Server Error! Please try again")}),file.upload.progress(function(evt){file.progress=Math.min(100,parseInt(100*evt.loaded/evt.total))}),file.upload}},templateUrl:Stratus.BaseUrl+Stratus.BundlePath+"components/mediaDragDrop"+(Stratus.Environment.get("production")?".min":"")+".html"}});