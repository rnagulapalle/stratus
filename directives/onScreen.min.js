!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","jquery","angular"],factory):factory(root.Stratus,root._,root.$,root.angular)}(this,function(Stratus,_,$,angular){Stratus.Directives.OnScreen=function($parse,$interpolate){return{restrict:"A",scope:{onScreen:"@onScreen",stratusOnScreen:"@stratusOnScreen",offScreen:"@offScreen",spy:"@spy",target:"@target",event:"@event",offset:"@offset",reset:"@reset"},link:function(scope,element,attrs){element.uid=_.uniqueId("on_screen_"),Stratus.Instances[element.uid]=scope,scope.elementId=attrs.elementId||element.uid;const event=attrs.event?attrs.event.split(" "):[],target=attrs.target?$(attrs.target):element,spy=attrs.spy?$(attrs.spy):element,offset=attrs.offset||0,reset=attrs.reset||0;console.log(attrs),Stratus.Internals.OnScroll(),Stratus.Environment.on("change:viewPortChange",function(model){let lastScroll=Stratus.Environment.get("lastScroll"),isReset=!1;-1!==event.indexOf("reset")&&(reset>0&&element.offset().top<=reset||$(window).scrollTop()<=0)&&(isReset=!0,target.removeClass("onScreen offScreen scrollUp scrollDown reveal unreveal")),isReset||("down"===lastScroll?target.addClass("scrollDown"):target.removeClass("scrollDown"),"up"===lastScroll?target.addClass("scrollUp"):target.removeClass("scrollUp"),"down"===lastScroll&&target.hasClass("reveal")?target.removeClass("reveal").addClass("unreveal"):"up"===lastScroll&&target.removeClass("unreveal").addClass("reveal"),"up"===lastScroll&&target.hasClass("revealDown")?target.removeClass("revealDown").addClass("unrevealDown"):"down"===lastScroll&&target.removeClass("unrevealDown").addClass("revealDown"),Stratus.Internals.IsOnScreen(spy,offset)?(target.removeClass("offScreen").addClass("onScreen onScreenInit"),!attrs.onScreen||"function"!=typeof attrs.onScreen||attrs.onScreen()):(target.removeClass("onScreen").addClass("offScreen"),!attrs.offScreen||"function"!=typeof attrs.offScreen||attrs.offScreen())),console.log("OnScreen:",{direction:lastScroll,spy:spy,reset:reset,isReset:isReset,offset:offset},Stratus.Internals.IsOnScreen(spy,offset))})}}}});