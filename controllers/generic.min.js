!function(root,factory){"function"==typeof define&&define.amd?define(["stratus","underscore","angular","stratus.services.registry","stratus.services.createNewSite"],factory):factory(root.Stratus,root._,root.angular)}(this,function(Stratus,_,angular){Stratus.Controllers.Generic=["$scope","$element","$log","$parse","Registry","createNewSite",function($scope,$element,$log,$parse,Registry,createNewSite){if(Stratus.Instances[_.uniqueId("generic_")]=$scope,$scope.registry=new Registry,$scope.registry.fetch($element,$scope),$scope.Stratus=Stratus,$scope._=_,$scope.setUrlParams=function(options){if(angular.isObject(options)){var substance=!1;angular.forEach(options,function(value){angular.isDefined(value)&&null!==value&&(angular.isString(value)?value.length>0&&(substance=!0):substance=!0)}),substance&&window.location.replace(Stratus.Internals.SetUrlParams(options))}},$scope.$log=$log,$scope.isArray=angular.isArray,$scope.isDate=angular.isDate,$scope.isDefined=angular.isDefined,$scope.isElement=angular.isElement,$scope.isFunction=angular.isFunction,$scope.isNumber=angular.isNumber,$scope.isObject=angular.isObject,$scope.isString=angular.isString,$scope.isUndefined=angular.isUndefined,$scope.createSite=function(siteTitle,siteGenreId,masterSite,masterContentMethod){var data={name:siteTitle,genre:siteGenreId,masterSite:masterSite,masterContentMethod:masterContentMethod};createNewSite.create(data).then(function(res){console.log(res)})},$scope.collection){var selected={id:$element.attr("data-selected"),raw:$element.attr("data-raw")};selected.id&&angular.isString(selected.id)&&(_.isJSON(selected.id)?(selected.id=JSON.parse(selected.id),$scope.$watch("collection.models",function(models){$scope.selected||$scope.selectedInit||angular.forEach(models,function(model){selected.id===model.getIdentifier()&&($scope.selected=selected.raw?model.data:model,$scope.selectedInit=!0)})})):(selected.model=$parse(selected.id),selected.value=selected.model($scope.$parent),angular.isArray(selected.value)&&(selected.value=selected.value.filter(function(n){return n}),selected.value.length&&($scope.selected=_.first(selected.value)))))}}]});